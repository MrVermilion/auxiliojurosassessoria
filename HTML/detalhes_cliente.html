<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes do Cliente</title>

    <!-- Importando a fonte e o estilo -->
    <link href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../CSS/style-clientes.css">

    <!-- Importando a biblioteca do Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        var client = false;
        var SUPABASE_INSTANCE = callInstanceSupabase();

        function getTokenSupabase() {
            return "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1rZGp1bHdyaXpnd3NoenNuYWZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjkxMDQwNjEsImV4cCI6MjA0NDY4MDA2MX0.D94BftAd0eflSZ3-EV5nu_oG2db9mNgiz8Tvtbg1zD4";
        }
        
        function getUrlApiSupabase() {
            return "https://mkdjulwrizgwshzsnafm.supabase.co";
        }

        function callInstanceSupabase() {
            if (!client) {
                let { createClient } = supabase;
                let url = getUrlApiSupabase();
                client = createClient(url, getTokenSupabase());
            }
            return client;
        }

        // Função para obter o ID do cliente da URL
        function getClienteIdFromUrl() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('id'); // Retorna o ID do cliente da URL
        }

        // Função para buscar e exibir os detalhes do cliente
        async function carregarDetalhesCliente() {
            const clienteId = getClienteIdFromUrl(); // Obtém o ID da URL

            // Busca os dados do cliente no Supabase
            let { data: cliente, error } = await SUPABASE_INSTANCE
                .from('cadastros')
                .select('*')
                .eq('id', clienteId)
                .single(); // Queremos apenas um único registro

            if (error) {
                alert("Erro ao carregar detalhes do cliente: " + error.message);
                return;
            }

            // Exibe os detalhes do cliente na página
            document.querySelector('#nome').textContent = cliente.usunome;
            document.querySelector('#id').textContent = cliente.id;
            document.querySelector('#dataNascimento').textContent = cliente.usunascimento; // Substitua pelo campo correto do banco
            document.querySelector('#cpf').textContent = cliente.usucpf;
            document.querySelector('#rg').textContent = cliente.usurg; // Substitua pelo campo correto do banco
            document.querySelector('#nacionalidade').textContent = cliente.usunacionalidade; // Substitua pelo campo correto do banco
            document.querySelector('#estadoCivil').textContent = cliente.usuestadocivil; // Substitua pelo campo correto do banco
            document.querySelector('#profissao').textContent = cliente.usuprofissao; // Substitua pelo campo correto do banco
            document.querySelector('#rua').textContent = cliente.usurua; // Substitua pelo campo correto do banco
            document.querySelector('#bairro').textContent = cliente.usubairro; // Substitua pelo campo correto do banco
            document.querySelector('#cidade').textContent = cliente.usucidade; // Substitua pelo campo correto do banco
            document.querySelector('#cep').textContent = cliente.usucep; // Substitua pelo campo correto do banco
            document.querySelector('#estado').textContent = cliente.usuestado; // Substitua pelo campo correto do banco
            document.querySelector('#email').textContent = cliente.usuemail;
            document.querySelector('#telefone').textContent = cliente.usutelefone;
            // Adicione aqui mais campos, conforme necessário
        }

        // Quando a página terminar de carregar, executa a função para carregar os detalhes
        document.addEventListener('DOMContentLoaded', carregarDetalhesCliente);
    </script>
</head>
<body>
    <header>
        <h1>Detalhes do Cliente</h1>
    </header>



    <div class="container">

        <nav class="menu">
            <ul>
                <li><a href="index.html">Página Inicial</a></li>
                <li><a href="cadastros.html">Cadastros</a></li>
                <li><a href="tarefas.html">Tarefas</a></li>
                <li><a href="clientes.html">Clientes</a></li>
                <li><a href="documentos.html">Documentos</a></li>
            </ul>
        </nav>

        <div class="content">
            <h2>Informações do Cliente</h2>
            <p><strong>ID:</strong> <span id="id"></span></p>
            <p><strong>Nome:</strong> <span id="nome"></span></p>
            <p><strong>Data de Nascimento:</strong> <span id="dataNascimento"></span></p>
            <p><strong>CPF nº:</strong> <span id="cpf"></span></p>
            <p><strong>RG nº:</strong> <span id="rg"></span></p>
            <p><strong>Nacionalidade:</strong> <span id="nacionalidade"></span></p>
            <p><strong>Estado Civil:</strong> <span id="estadoCivil"></span></p>
            <p><strong>Profissão:</strong> <span id="profissao"></span></p>
            <p><strong>Rua:</strong> <span id="rua"></span></p>
            <p><strong>Bairro:</strong> <span id="bairro"></span></p>
            <p><strong>Cidade:</strong> <span id="cidade"></span></p>
            <p><strong>CEP:</strong> <span id="cep"></span></p>
            <p><strong>Estado:</strong> <span id="estado"></span></p>
            <p><strong>E-mail:</strong> <span id="email"></span></p>
            <p><strong>Telefone:</strong> <span id="telefone"></span></p>
            </script>
        </div>

        <script>
            function voltarPagina() {
                window.history.back(); // Volta para a página anterior
            }
        </script>
    </div>
        <!-- Botão Voltar -->
        <button id="btnVoltar" onclick="voltarPagina()">Voltar</button>
</body>
</html>
